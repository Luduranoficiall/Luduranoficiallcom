{% extends "admin/dashboard.html" %}

{% block title %}{{ 'Editar' if post else 'Novo' }} Post | Admin{% endblock %}

{% block admin_header %}
<h1>{% if post %}✏️ EDITAR POST{% else %}➕ NOVO POST{% endif %}</h1>
<p class="section-lead">Mantenha o blog atualizado com conteúdos estratégicos.</p>
{% endblock %}

{% block admin_content %}
<div class="admin-form-wrapper">
    <div class="card form-card admin-form-card">
    <form method="POST" enctype="multipart/form-data" action="{% if post %}{{ url_for('edit_post', post_id=post.id) }}{% else %}{{ url_for('create_post') }}{% endif %}">
        <div class="form-group">
            <label for="title">TÍTULO DO POST</label>
            <input type="text" id="title" name="title" placeholder="Digite um título impactante" value="{{ post.title if post else '' }}" required class="form-control form-control-xl">
        </div>

        <div class="form-group">
            <label for="excerpt">RESUMO (OPCIONAL)</label>
            <input type="text" id="excerpt" name="excerpt" placeholder="Resumo curto para cards e SEO" value="{{ post.excerpt if post else '' }}" class="form-control form-control-lg">
            <p class="form-hint">
                <i class="fas fa-info-circle"></i> Utilizado na listagem do blog e metadescription. Será gerado automaticamente se vazio.
            </p>
        </div>

        <div class="form-group">
            <label for="cover_image">CAPA DO POST (OPCIONAL)</label>
            <input type="file" id="cover_image" name="cover_image" accept="image/png, image/jpeg, image/webp, image/gif" class="form-control input-file">
            <p class="form-hint">
                <i class="fas fa-info-circle"></i> Formatos aceitos: PNG, JPG, JPEG, WEBP. Tamanho máximo 5 MB.
            </p>
            {% if post and post.cover_image %}
            <div class="preview-block">
                <strong class="preview-title">Capa atual:</strong>
                <img src="{{ url_for('static', filename=post.cover_image) }}" alt="Capa atual do post" class="preview-image">
            </div>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="content">CONTEÚDO</label>
            <textarea id="content" name="content" placeholder="Escreva o conteúdo do post..." required class="form-control textarea-xl">{{ post.content if post else '' }}</textarea>
            <p class="form-hint">
                <i class="fas fa-info-circle"></i> Você pode usar HTML para formatação avançada (títulos, listas, imagens, etc.).
            </p>
        </div>

        <div class="action-row spaced wrap">
            <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-save"></i> {% if post %}ATUALIZAR POST{% else %}PUBLICAR POST{% endif %}
            </button>
            <a href="{{ url_for('admin_blog') }}" class="btn btn-secondary btn-lg">
                <i class="fas fa-times"></i> CANCELAR
            </a>
        </div>
    </form>
    </div>
</div>
{% endblock %}