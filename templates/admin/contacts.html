{% extends "admin/dashboard.html" %}

{% block title %}Mensagens | Admin{% endblock %}

{% block admin_header %}
<h1>ðŸ“¨ GERENCIAR MENSAGENS</h1>
<p class="admin-summary">Total: <strong class="text-accent">{{ contacts|length }}</strong> mensagens recebidas</p>
{% endblock %}

{% block admin_header_actions %}
<div class="action-row tight">
    <a href="{{ url_for('export_contacts') }}" class="btn btn-secondary btn-lg">
        <i class="fas fa-file-download"></i> Exportar CSV
    </a>
</div>
{% endblock %}

{% block admin_content %}
<div class="recent-list">
    {% for contact in contacts %}
    <div class="card recent-item">
        <div class="recent-item-header">
            <div>
                <div class="recent-item-title">{{ contact.name }}</div>
                <div class="recent-item-contact">
                    <i class="fas fa-envelope"></i> <a href="mailto:{{ contact.email }}" class="link-accent">{{ contact.email }}</a>
                </div>
            </div>
            <div class="recent-item-meta">
                {% if not contact.read %}
                <span class="badge badge-new">NOVA</span>
                {% endif %}
                <div class="recent-item-date">
                    <i class="fas fa-clock"></i> {{ contact.created_at.strftime('%d/%m/%Y Ã s %H:%M') }}
                </div>
            </div>
        </div>
        <div class="recent-item-content content-divider">
            {{ contact.message }}
        </div>
        <div class="action-row tight wrap">
            {% if not contact.read %}
            <form method="POST" action="{{ url_for('mark_contact_read', contact_id=contact.id) }}" class="inline-form">
                <button type="submit" class="btn btn-secondary btn-md">
                    <i class="fas fa-check"></i> Marcar como Lida
                </button>
            </form>
            {% endif %}
            <form method="POST" action="{{ url_for('delete_contact', contact_id=contact.id) }}" class="inline-form">
                <button type="submit" class="btn btn-secondary logout-btn btn-md" onclick="return confirm('Tem certeza que deseja excluir esta mensagem?')">
                    <i class="fas fa-trash"></i> Excluir
                </button>
            </form>
        </div>
    </div>
    {% else %}
    <div class="card admin-empty-card">
        <i class="fas fa-inbox admin-empty-icon"></i>
        <h2 class="admin-empty-title">Nenhuma Mensagem</h2>
        <p class="admin-empty-text">As mensagens dos clientes aparecerÃ£o aqui</p>
    </div>
    {% endfor %}
</div>
{% endblock %}